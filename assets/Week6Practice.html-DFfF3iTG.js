import{_ as t}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as e,d as n,o as i}from"./app-BP31YoJ7.js";const s="/data/unisa/AdvancedAnalytic1/w6/rainfall_beformaximizing.png",l="/data/unisa/AdvancedAnalytic1/w6/rainfall_solver.png",o="/data/unisa/AdvancedAnalytic1/w6/rainfall.png",r="/data/unisa/AdvancedAnalytic1/w6/histogram_bins.png",c="/data/unisa/AdvancedAnalytic1/w6/histogram_tool.png",d="/data/unisa/AdvancedAnalytic1/w6/histogram_tool_parameters.png",h="/data/unisa/AdvancedAnalytic1/w6/histogram_result.png",m="/data/unisa/AdvancedAnalytic1/w6/FrequencyAndGammaFrequency.png",p={};function g(u,a){return i(),e("div",null,a[0]||(a[0]=[n(`<h2 id="rainfall-modelling-w6" tabindex="-1"><a class="header-anchor" href="#rainfall-modelling-w6"><span>Rainfall Modelling (W6)</span></a></h2><h3 id="part1-getting-gamma-model-parameters" tabindex="-1"><a class="header-anchor" href="#part1-getting-gamma-model-parameters"><span>Part1: Getting Gamma model parameters</span></a></h3><ul><li><p>The instructions</p><div class="hint-container info"><p class="hint-container-title">instructions</p><ol><li>Take the file called <code>PoorakaMonthlyFit.xls</code>. It contains a sheet that shows the fitting procedure <span style="color:orange;">using Likelihood to fit a Gamma Distribution</span> to data for the 87 years for June for Pooraka. Try matching moments to see what you get for the parameters as well.</li><li>You are to repeat this for May-September. Check out both the methods and apply to the other months. Then see about in each case.</li></ol></div></li><li><p>Setting Parameters</p></li></ul><div class="language-vba line-numbers-mode" data-highlighter="shiki" data-ext="vba" data-title="vba" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>&#39;The likelihood fomula</span></span>
<span class="line"><span>B3 = (E$2-1)*LN(A3)-A3/$E$3-$E$2*LN($E$3)-$E$4</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&#39;initialize the α and β</span></span>
<span class="line"><span>D1 = 1</span></span>
<span class="line"><span>D2 = 2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Other cells please refer to the picture below to fill.<br><img src="`+s+'" alt="The formula before maximizing" width="700" loading="lazy"></p><p>Using the solver to maximize the sum of likelihood. Please set the parameter follow the picture below.<br><img src="'+l+'" alt="Using solver to maximize" width="500" loading="lazy"></p><ul><li>Note:<div class="hint-container info"><p class="hint-container-title">Info</p><p>Please note, it is necessary add a constraint that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo separator="true">,</mo><mi>β</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\\alpha, \\beta &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>.</p></div></li></ul><p>After maximizing, the result will be like the picture below.<br><img src="'+o+'" alt="The formula" width="700" loading="lazy"></p><h3 id="part2-getting-gamma-distribution-data" tabindex="-1"><a class="header-anchor" href="#part2-getting-gamma-distribution-data"><span>Part2: Getting gamma distribution data</span></a></h3><ul><li>The instructions<div class="hint-container info"><p class="hint-container-title">instructions</p><ol start="3"><li>For synthetic generation, it is a little more complicated but not much. I have gone to Data Analysis and then Random Number Generation. Pick 1 variable, and 3000 values (I did 200 just to make sure the file was small), Uniform Distribution, and then the range is [0.0001,0.9999] so we don’t get any odd values in the synthetic generation. The Output Range starts in <code>A5</code>. In <code>B5</code>, you will see I have the formula <code>=GAMMAINV(A5,$D$1,$D$2)</code>. That selects the rainfall total from the <code>Gamma Distribution</code> with our parameter estimates that corresponds to the probability in <code>A5</code>. Copy that down for all the values in column A. Repeat for all months. Then, put the synthetic monthly totals in adjoining columns in a new sheet. Find the seasonal totals for all 3000 cases. Put the columns of historical data side by side in the same sheet. Once again find the totals. Then using the Histogram menu item on Data Analysis, compare the two sets of totals – you will need to use the cumulative probability option.</li><li>Markov Equilibrium Vector. In cells <code>A1:B2</code> put the values of the transition matrix for the daily rainfall, 0.73, 0.27, 0.36, 0.64 from the workshop. The next part is tricky so follow carefully. Highlight cells <code>D1:E2</code>, and enter the formula <code>=mmult(A1:B2,A1:B2)</code> and hold down the shift and control keys and then hit enter. You will get the transition matrix squared. Square this result in cells <code>G1:H2</code>, using the same technique. Repeat until you get convergence. How many powers of the matrix did you get to for convergence? Now calculate the equilibrium vector by using the procedure given in the workshop and compare results.</li></ol></div></li></ul><h3 id="getting-histogram" tabindex="-1"><a class="header-anchor" href="#getting-histogram"><span>Getting histogram</span></a></h3><p><strong>Step 1：</strong> Get max and min of the data.<br><strong>Step 2：</strong> Construct the bins data of the data.<br><img src="'+r+'" alt="Histogram Bins" loading="lazy"></p><p><strong>Step 3：</strong> Using the histogram tool to generate frequencies.<br><img src="'+c+'" alt="histogram tool" width="300" loading="lazy"></p><p><img src="'+d+'" alt="Alt text" loading="lazy"><br><img src="'+h+`" alt="Alt text" loading="lazy"></p><h3 id="geting-gamma-data" tabindex="-1"><a class="header-anchor" href="#geting-gamma-data"><span>Geting GAMMA.DATA</span></a></h3><p><strong>Step 1:</strong> Constructing data</p><div class="language-vba line-numbers-mode" data-highlighter="shiki" data-ext="vba" data-title="vba" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>Q2 = O2/2</span></span>
<span class="line"><span>Q3 = Q2+5</span></span>
<span class="line"><span>R2 = GAMMA.DIST(Q2,$E$2,$E$3,FALSE())</span></span>
<span class="line"><span>S2 = R2*$H$26*5</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Step 2:</strong> Visualize the frequency and Gamma frequency<br><img src="`+m+'" alt="Final Result" loading="lazy"></p><h2 id="download-sample-dataset" tabindex="-1"><a class="header-anchor" href="#download-sample-dataset"><span><a href="/data/unisa/AdvancedAnalytic1/w6/PoorakaMonthlyFit.xlsx">Download Sample Dataset</a></span></a></h2>',19)]))}const b=t(p,[["render",g],["__file","Week6Practice.html.vue"]]),v=JSON.parse(`{"path":"/study/unisa/2023SP5/AdvancedAnalyticTechniques1/Week6Practice.html","title":"Prac: Rainfall (GAMMA)","lang":"en-US","frontmatter":{"title":"Prac: Rainfall (GAMMA)","index":true,"icon":"/assets/icon/common/practices.svg","author":"Haiyue","date":"2023-08-31T00:00:00.000Z","category":["math"],"tag":["Rain","excel"],"description":"Rainfall Modelling (W6) Part1: Getting Gamma model parameters The instructions instructions Take the file called PoorakaMonthlyFit.xls. It contains a sheet that shows the fittin...","gitInclude":[],"head":[["meta",{"property":"og:url","content":"https://jet-w.github.io/study/unisa/2023SP5/AdvancedAnalyticTechniques1/Week6Practice.html"}],["meta",{"property":"og:site_name","content":"Haiyue's Blog"}],["meta",{"property":"og:title","content":"Prac: Rainfall (GAMMA)"}],["meta",{"property":"og:description","content":"Rainfall Modelling (W6) Part1: Getting Gamma model parameters The instructions instructions Take the file called PoorakaMonthlyFit.xls. It contains a sheet that shows the fittin..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://jet-w.github.io/data/unisa/AdvancedAnalytic1/w6/rainfall_beformaximizing.png =700x"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"article:author","content":"Haiyue"}],["meta",{"property":"article:tag","content":"Rain"}],["meta",{"property":"article:tag","content":"excel"}],["meta",{"property":"article:published_time","content":"2023-08-31T00:00:00.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Prac: Rainfall (GAMMA)\\",\\"image\\":[\\"https://jet-w.github.io/data/unisa/AdvancedAnalytic1/w6/rainfall_beformaximizing.png =700x\\",\\"https://jet-w.github.io/data/unisa/AdvancedAnalytic1/w6/rainfall_solver.png =500x\\",\\"https://jet-w.github.io/data/unisa/AdvancedAnalytic1/w6/rainfall.png =700x\\",\\"https://jet-w.github.io/data/unisa/AdvancedAnalytic1/w6/histogram_bins.png\\",\\"https://jet-w.github.io/data/unisa/AdvancedAnalytic1/w6/histogram_tool.png =300x\\",\\"https://jet-w.github.io/data/unisa/AdvancedAnalytic1/w6/histogram_tool_parameters.png\\",\\"https://jet-w.github.io/data/unisa/AdvancedAnalytic1/w6/histogram_result.png\\",\\"https://jet-w.github.io/data/unisa/AdvancedAnalytic1/w6/FrequencyAndGammaFrequency.png\\"],\\"datePublished\\":\\"2023-08-31T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Haiyue\\"}]}"]]},"headers":[{"level":2,"title":"Rainfall Modelling (W6)","slug":"rainfall-modelling-w6","link":"#rainfall-modelling-w6","children":[{"level":3,"title":"Part1: Getting Gamma model parameters","slug":"part1-getting-gamma-model-parameters","link":"#part1-getting-gamma-model-parameters","children":[]},{"level":3,"title":"Part2: Getting gamma distribution data","slug":"part2-getting-gamma-distribution-data","link":"#part2-getting-gamma-distribution-data","children":[]},{"level":3,"title":"Getting histogram","slug":"getting-histogram","link":"#getting-histogram","children":[]},{"level":3,"title":"Geting GAMMA.DATA","slug":"geting-gamma-data","link":"#geting-gamma-data","children":[]}]},{"level":2,"title":"Download Sample Dataset","slug":"download-sample-dataset","link":"#download-sample-dataset","children":[]}],"readingTime":{"minutes":1.96,"words":589},"filePathRelative":"study/unisa/2023SP5/AdvancedAnalyticTechniques1/Week6Practice.md","localizedDate":"August 31, 2023","excerpt":"<h2>Rainfall Modelling (W6)</h2>\\n<h3>Part1: Getting Gamma model parameters</h3>\\n<ul>\\n<li>\\n<p>The instructions</p>\\n<div class=\\"hint-container info\\">\\n<p class=\\"hint-container-title\\">instructions</p>\\n<ol>\\n<li>Take the file called <code>PoorakaMonthlyFit.xls</code>.  It contains a sheet that shows the fitting procedure <span style=\\"color:orange\\">using Likelihood to fit a Gamma Distribution</span> to data for the 87 years for June for Pooraka.  Try matching moments to see what you get for the parameters as well.</li>\\n<li>You are to repeat this for May-September.  Check out both the methods and apply to the other months.  Then see about in each case.</li>\\n</ol>\\n</div>\\n</li>\\n<li>\\n<p>Setting Parameters</p>\\n</li>\\n</ul>","autoDesc":true}`);export{b as comp,v as data};

import{_ as l}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as n,b as e,e as a,h as i,o as s}from"./app-B-R930Zm.js";const o="/data/unisa/AdvancedAnalytic1/w6/rainfall_beformaximizing.png",r="/data/unisa/AdvancedAnalytic1/w6/rainfall_solver.png",d="/data/unisa/AdvancedAnalytic1/w6/rainfall.png",h="/data/unisa/AdvancedAnalytic1/w6/histogram_bins.png",c="/data/unisa/AdvancedAnalytic1/w6/histogram_tool.png",m="/data/unisa/AdvancedAnalytic1/w6/histogram_tool_parameters.png",p="/data/unisa/AdvancedAnalytic1/w6/histogram_result.png",g="/data/unisa/AdvancedAnalytic1/w6/FrequencyAndGammaFrequency.png",u={},f={class:"hint-container info"},y={class:"MathJax",jax:"SVG",style:{position:"relative"}},b={style:{"vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.883ex",height:"2.034ex",role:"img",focusable:"false",viewBox:"0 -705 3484.2 899","aria-hidden":"true"};function v(T,t){return s(),n("div",null,[t[6]||(t[6]=e(`<h2 id="rainfall-modelling-w6" tabindex="-1"><a class="header-anchor" href="#rainfall-modelling-w6"><span>Rainfall Modelling (W6)</span></a></h2><h3 id="part1-getting-gamma-model-parameters" tabindex="-1"><a class="header-anchor" href="#part1-getting-gamma-model-parameters"><span>Part1: Getting Gamma model parameters</span></a></h3><ul><li><p>The instructions</p><div class="hint-container info"><p class="hint-container-title">instructions</p><ol><li>Take the file called <code>PoorakaMonthlyFit.xls</code>. It contains a sheet that shows the fitting procedure <span style="color:orange;">using Likelihood to fit a Gamma Distribution</span> to data for the 87 years for June for Pooraka. Try matching moments to see what you get for the parameters as well.</li><li>You are to repeat this for May-September. Check out both the methods and apply to the other months. Then see about in each case.</li></ol></div></li><li><p>Setting Parameters</p></li></ul><div class="language-vba line-numbers-mode" data-highlighter="shiki" data-ext="vba" data-title="vba" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>&#39;The likelihood fomula</span></span>
<span class="line"><span>B3 = (E$2-1)*LN(A3)-A3/$E$3-$E$2*LN($E$3)-$E$4</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&#39;initialize the α and β</span></span>
<span class="line"><span>D1 = 1</span></span>
<span class="line"><span>D2 = 2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Other cells please refer to the picture below to fill.<br><img src="`+o+'" alt="The formula before maximizing" width="700" loading="lazy"></p><p>Using the solver to maximize the sum of likelihood. Please set the parameter follow the picture below.<br><img src="'+r+'" alt="Using solver to maximize" width="500" loading="lazy"></p>',6)),a("ul",null,[a("li",null,[t[5]||(t[5]=i("Note:")),a("div",f,[t[4]||(t[4]=a("p",{class:"hint-container-title"},"Info",-1)),a("p",null,[t[2]||(t[2]=i("Please note, it is necessary add a constraint that ")),a("mjx-container",y,[(s(),n("svg",b,t[0]||(t[0]=[e('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374Q564 388 566 390T582 393Q603 393 603 385Q603 376 594 346T558 261T497 161L486 147L487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62Q597 56 591 43Q579 19 556 5T512 -10H505Q438 -10 414 62L411 69L400 61Q390 53 370 41T325 18T267 -2T203 -11Q124 -11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290Q382 405 304 405Q235 405 183 332Q156 292 139 224T121 120Q121 71 146 49T208 26Z"></path></g><g data-mml-node="mo" transform="translate(640,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(1084.7,0)"><path data-c="1D6FD" d="M29 -194Q23 -188 23 -186Q23 -183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252Q533 139 448 65T257 -10Q227 -10 203 -2T165 17T143 40T131 59T126 65L62 -188Q60 -194 42 -194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439T461 453T472 471T484 495T493 524T501 560Q503 569 503 593Q503 611 502 616Q487 667 426 667Q384 667 347 643T286 582T247 514T224 455Q219 439 186 308T152 168Q151 163 151 147Q151 99 173 68Q204 26 260 26Q302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372Q380 358 347 358H337Q258 358 258 389Q258 396 261 403Q275 431 353 431Z"></path></g><g data-mml-node="mo" transform="translate(1928.4,0)"><path data-c="3E" d="M84 520Q84 528 88 533T96 539L99 540Q106 540 253 471T544 334L687 265Q694 260 694 250T687 235Q685 233 395 96L107 -40H101Q83 -38 83 -20Q83 -19 83 -17Q82 -10 98 -1Q117 9 248 71Q326 108 378 132L626 250L378 368Q90 504 86 509Q84 513 84 520Z"></path></g><g data-mml-node="mn" transform="translate(2984.2,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g></g>',1)]))),t[1]||(t[1]=a("mjx-assistive-mml",{unselectable:"on",display:"inline"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("mi",null,"α"),a("mo",null,","),a("mi",null,"β"),a("mo",null,">"),a("mn",null,"0")])],-1))]),t[3]||(t[3]=i("."))])])])]),t[7]||(t[7]=e('<p>After maximizing, the result will be like the picture below.<br><img src="'+d+'" alt="The formula" width="700" loading="lazy"></p><h3 id="part2-getting-gamma-distribution-data" tabindex="-1"><a class="header-anchor" href="#part2-getting-gamma-distribution-data"><span>Part2: Getting gamma distribution data</span></a></h3><ul><li>The instructions<div class="hint-container info"><p class="hint-container-title">instructions</p><ol start="3"><li>For synthetic generation, it is a little more complicated but not much. I have gone to Data Analysis and then Random Number Generation. Pick 1 variable, and 3000 values (I did 200 just to make sure the file was small), Uniform Distribution, and then the range is [0.0001,0.9999] so we don’t get any odd values in the synthetic generation. The Output Range starts in <code>A5</code>. In <code>B5</code>, you will see I have the formula <code>=GAMMAINV(A5,$D$1,$D$2)</code>. That selects the rainfall total from the <code>Gamma Distribution</code> with our parameter estimates that corresponds to the probability in <code>A5</code>. Copy that down for all the values in column A. Repeat for all months. Then, put the synthetic monthly totals in adjoining columns in a new sheet. Find the seasonal totals for all 3000 cases. Put the columns of historical data side by side in the same sheet. Once again find the totals. Then using the Histogram menu item on Data Analysis, compare the two sets of totals – you will need to use the cumulative probability option.</li><li>Markov Equilibrium Vector. In cells <code>A1:B2</code> put the values of the transition matrix for the daily rainfall, 0.73, 0.27, 0.36, 0.64 from the workshop. The next part is tricky so follow carefully. Highlight cells <code>D1:E2</code>, and enter the formula <code>=mmult(A1:B2,A1:B2)</code> and hold down the shift and control keys and then hit enter. You will get the transition matrix squared. Square this result in cells <code>G1:H2</code>, using the same technique. Repeat until you get convergence. How many powers of the matrix did you get to for convergence? Now calculate the equilibrium vector by using the procedure given in the workshop and compare results.</li></ol></div></li></ul><h3 id="getting-histogram" tabindex="-1"><a class="header-anchor" href="#getting-histogram"><span>Getting histogram</span></a></h3><p><strong>Step 1：</strong> Get max and min of the data.<br><strong>Step 2：</strong> Construct the bins data of the data.<br><img src="'+h+'" alt="Histogram Bins" loading="lazy"></p><p><strong>Step 3：</strong> Using the histogram tool to generate frequencies.<br><img src="'+c+'" alt="histogram tool" width="300" loading="lazy"></p><p><img src="'+m+'" alt="Alt text" loading="lazy"><br><img src="'+p+`" alt="Alt text" loading="lazy"></p><h3 id="geting-gamma-data" tabindex="-1"><a class="header-anchor" href="#geting-gamma-data"><span>Geting GAMMA.DATA</span></a></h3><p><strong>Step 1:</strong> Constructing data</p><div class="language-vba line-numbers-mode" data-highlighter="shiki" data-ext="vba" data-title="vba" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>Q2 = O2/2</span></span>
<span class="line"><span>Q3 = Q2+5</span></span>
<span class="line"><span>R2 = GAMMA.DIST(Q2,$E$2,$E$3,FALSE())</span></span>
<span class="line"><span>S2 = R2*$H$26*5</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Step 2:</strong> Visualize the frequency and Gamma frequency<br><img src="`+g+'" alt="Final Result" loading="lazy"></p><h2 id="download-sample-dataset" tabindex="-1"><a class="header-anchor" href="#download-sample-dataset"><span><a href="/data/unisa/AdvancedAnalytic1/w6/PoorakaMonthlyFit.xlsx">Download Sample Dataset</a></span></a></h2>',12))])}const w=l(u,[["render",v],["__file","Week6Practice.html.vue"]]),k=JSON.parse(`{"path":"/study/unisa/2023SP5/AdvancedAnalyticTechniques1/Week6Practice.html","title":"Prac: Rainfall (GAMMA)","lang":"en-US","frontmatter":{"title":"Prac: Rainfall (GAMMA)","index":true,"icon":"/assets/icon/common/practices.svg","author":"Haiyue","date":"2023-08-31T00:00:00.000Z","category":["math"],"tag":["Rain","excel"],"description":"Rainfall Modelling (W6) Part1: Getting Gamma model parameters The instructions instructions Take the file called PoorakaMonthlyFit.xls. It contains a sheet that shows the fittin...","gitInclude":[],"head":[["meta",{"property":"og:url","content":"https://jet-w.github.io/study/unisa/2023SP5/AdvancedAnalyticTechniques1/Week6Practice.html"}],["meta",{"property":"og:site_name","content":"Haiyue's Blog"}],["meta",{"property":"og:title","content":"Prac: Rainfall (GAMMA)"}],["meta",{"property":"og:description","content":"Rainfall Modelling (W6) Part1: Getting Gamma model parameters The instructions instructions Take the file called PoorakaMonthlyFit.xls. It contains a sheet that shows the fittin..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://jet-w.github.io/data/unisa/AdvancedAnalytic1/w6/rainfall_beformaximizing.png =700x"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"article:author","content":"Haiyue"}],["meta",{"property":"article:tag","content":"Rain"}],["meta",{"property":"article:tag","content":"excel"}],["meta",{"property":"article:published_time","content":"2023-08-31T00:00:00.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Prac: Rainfall (GAMMA)\\",\\"image\\":[\\"https://jet-w.github.io/data/unisa/AdvancedAnalytic1/w6/rainfall_beformaximizing.png =700x\\",\\"https://jet-w.github.io/data/unisa/AdvancedAnalytic1/w6/rainfall_solver.png =500x\\",\\"https://jet-w.github.io/data/unisa/AdvancedAnalytic1/w6/rainfall.png =700x\\",\\"https://jet-w.github.io/data/unisa/AdvancedAnalytic1/w6/histogram_bins.png\\",\\"https://jet-w.github.io/data/unisa/AdvancedAnalytic1/w6/histogram_tool.png =300x\\",\\"https://jet-w.github.io/data/unisa/AdvancedAnalytic1/w6/histogram_tool_parameters.png\\",\\"https://jet-w.github.io/data/unisa/AdvancedAnalytic1/w6/histogram_result.png\\",\\"https://jet-w.github.io/data/unisa/AdvancedAnalytic1/w6/FrequencyAndGammaFrequency.png\\"],\\"datePublished\\":\\"2023-08-31T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Haiyue\\"}]}"]]},"headers":[{"level":2,"title":"Rainfall Modelling (W6)","slug":"rainfall-modelling-w6","link":"#rainfall-modelling-w6","children":[{"level":3,"title":"Part1: Getting Gamma model parameters","slug":"part1-getting-gamma-model-parameters","link":"#part1-getting-gamma-model-parameters","children":[]},{"level":3,"title":"Part2: Getting gamma distribution data","slug":"part2-getting-gamma-distribution-data","link":"#part2-getting-gamma-distribution-data","children":[]},{"level":3,"title":"Getting histogram","slug":"getting-histogram","link":"#getting-histogram","children":[]},{"level":3,"title":"Geting GAMMA.DATA","slug":"geting-gamma-data","link":"#geting-gamma-data","children":[]}]},{"level":2,"title":"Download Sample Dataset","slug":"download-sample-dataset","link":"#download-sample-dataset","children":[]}],"readingTime":{"minutes":1.96,"words":589},"filePathRelative":"study/unisa/2023SP5/AdvancedAnalyticTechniques1/Week6Practice.md","localizedDate":"August 31, 2023","excerpt":"<h2>Rainfall Modelling (W6)</h2>\\n<h3>Part1: Getting Gamma model parameters</h3>\\n<ul>\\n<li>\\n<p>The instructions</p>\\n<div class=\\"hint-container info\\">\\n<p class=\\"hint-container-title\\">instructions</p>\\n<ol>\\n<li>Take the file called <code>PoorakaMonthlyFit.xls</code>.  It contains a sheet that shows the fitting procedure <span style=\\"color:orange\\">using Likelihood to fit a Gamma Distribution</span> to data for the 87 years for June for Pooraka.  Try matching moments to see what you get for the parameters as well.</li>\\n<li>You are to repeat this for May-September.  Check out both the methods and apply to the other months.  Then see about in each case.</li>\\n</ol>\\n</div>\\n</li>\\n<li>\\n<p>Setting Parameters</p>\\n</li>\\n</ul>","autoDesc":true}`);export{w as comp,k as data};

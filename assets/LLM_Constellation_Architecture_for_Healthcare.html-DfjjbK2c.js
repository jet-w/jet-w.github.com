import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as e,a as t,o as n}from"./app-CQersmFQ.js";const i="/assets/image-BrNYO3WE.png",l="/assets/image-1-DzaOW6-q.png",r="/assets/image-2-W7NjHbIc.png",p="/assets/image-3-B-BmYfAh.png",o="/assets/image-4-Cvz7fWxu.png",m={};function c(h,s){return n(),e("div",null,s[0]||(s[0]=[t('<ol><li>Information came from <a href="https://people.unisa.edu.au/srecko.joksimovic" target="_blank" rel="noopener noreferrer">George</a> in Discord channel <code>meeting summaries</code> at 1:33pm 4 July 2024.</li><li>This is the notes for paper &quot;<a href="https://arxiv.org/pdf/2403.13313" target="_blank" rel="noopener noreferrer">Polaris: A Safety-focused LLM Constellation Architecture for Healthcare</a>&quot;. The online version is <a href="https://arxiv.org/html/2403.13313v1#S1" target="_blank" rel="noopener noreferrer">here</a>.</li><li><a href="https://drive.google.com/file/d/1-WoevgM9sMV0jD9NkvaheHhcr5vprGSx/view?usp=sharing" target="_blank" rel="noopener noreferrer">Notes on Drawio</a></li></ol><h2 id="abstract" tabindex="-1"><a class="header-anchor" href="#abstract"><span>Abstract</span></a></h2><p>We develop Polaris 1, the first safety-focused Large Language Model (LLM) constellation for real-time patient-AI healthcare conversations. Unlike prior LLM works in healthcare, which focus on tasks like question answering, <span style="color:orange;">our work specifically focuses on long multi-turn voice conversations</span>. Our <span style="color:orange;">one-trillion parameter constellation system</span> is composed of <span style="color:orange;">several multi-billion parameter LLMs</span> as co-operative agents: <span style="color:orange;">a stateful primary agent</span> that focuses on driving an engaging patient-friendly conversation and <span style="color:orange;">several specialist support agents</span> focused on healthcare tasks performed by nurses, social workers, and nutritionists to increase safety and reduce hallucinations. We develop a sophisticated training protocol for iterative co-training of the agents that optimize for diverse objectives.</p><p>We train our models on proprietary data, clinical care plans, healthcare regulatory documents, medical manuals, and other medical reasoning documents. We further align our models to speak like medical professionals, using organic healthcare conversations and simulated ones between patient actors and experienced care-management nurses. This allows our system to express unique capabilities such as rapport building, trust building, empathy and bedside manner augmented with advanced medical reasoning.</p><p>Finally, we present the first comprehensive clinician evaluation of an LLM system for healthcare. We recruited over 1100 U.S. licensed nurses and over 130 U.S. licensed physicians to perform end-to-end conversational evaluations of our system by posing as patients and rating the system on several fine-grained measures. We demonstrate Polaris performs on par with human nurses on aggregate across dimensions such as medical safety, clinical readiness, patient education, conversational quality, and bedside manner. Additionally, we conduct a challenging task-based evaluation of the individual specialist support agents, where we demonstrate our LLM agents significantly outperform a much larger general-purpose LLM (GPT-4) as well as one from its own medium-size class (LLaMA-2 70B).</p><h2 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction"><span>Introduction</span></a></h2><figure><img src="https://arxiv.org/html/2403.13313v1/x1.png" alt="Figure 1:High level overview of our LLM constellation architecture Polaris." tabindex="0" loading="lazy"><figcaption>Figure 1:High level overview of our LLM constellation architecture Polaris.</figcaption></figure><div class="hint-container info"><p class="hint-container-title">Note</p><p>(a)Overview of our architecture, comprising of the Automatic Speech Recognition (ASR) for speech transcription, Polaris for processing the textual utterances, and Text-To-Speech (TTS) for the audio output. The constellation within Polaris contains a primary LLM agent driving the conversation, and several specialist LLM agents providing task-specific context to it.</p></div><div style="display:flex;"><div style="flex:1;"><figure><img src="https://arxiv.org/html/2403.13313v1/x2.png" alt="(b)Conversation snippet between Polaris and a simulated Patient, emphasizing empathy and rapport building as part of good bedside manner, while providing accurate medical information using lab specialist agent’s assistance." tabindex="0" loading="lazy"><figcaption>(b)Conversation snippet between Polaris and a simulated Patient, emphasizing empathy and rapport building as part of good bedside manner, while providing accurate medical information using lab specialist agent’s assistance.</figcaption></figure></div><div style="flex:1;"><figure><img src="https://arxiv.org/html/2403.13313v1/extracted/5481978/images/result-main.png" alt="(c)Comparative evaluation between human nurses (U.S. licensed) and Polaris on bedside manner (e.g., empathy, trust, rapport), medical safety, patient education, clinical readiness and overall conversation quality. Overall, Polaris is strikingly close to human nurse performance, and even outperforms them on some key dimensions." tabindex="0" loading="lazy"><figcaption>(c)Comparative evaluation between human nurses (U.S. licensed) and Polaris on bedside manner (e.g., empathy, trust, rapport), medical safety, patient education, clinical readiness and overall conversation quality. Overall, Polaris is strikingly close to human nurse performance, and even outperforms them on some key dimensions.</figcaption></figure></div></div><p>Recent progress in large language models (LLMs) has shown their impressive capability to plan, reason and interact with humans for a variety of tasks such as web search web, coding Bird et al. (2023), and intelligent content creation Ray (2023). The scaling of LLMs and the datasets used to train them, together with new architectural advances has contributed greatly to the advances in AI capabilities, and shown to surpass human performance in various benchmark tasks sur. These new capabilities are enabling real-world applications that were impossible until very recently such as those in healthcare.</p><p><strong>Healthcare specialization.</strong> Amidst the several domains and applications, healthcare remains a high-stake domain where errors may have fatal implications. The advent of GPT-4 Achiam et al. (2023) has led to a profound surge in the use of AI for healthcare applications, including clinical note and electronic health record processing (see Lee et al. (2023) for overview). While systems like MedPALM Singhal et al. (2023a) and GPT-4 have shown impressive results in general medical benchmarks like USMLE, recent work shows significant error rate for more specialized use-cases like pediatrics Barile et al. (2024). Among the failures, researchers observe that the AI systems struggle to spot known relationships between conditions that an experienced physician would look for, e.g., for a patient with autism, a physician might check for dietary deficiencies. Jacobsen and DeNiro (2017). The researchers note that these systems could be improved by selectively training on accurate and high quality medical literature, not just general articles over the internet, which are typically what most LLMs are trained on. Furthermore, it is possible that the base knowledge about autism leading to nutrient deficiencies is present in the LLMs; what is missing is the medical reasoning to connect the dots (i.e., some patients with autism exhibit narrow dietary preferences, which can then lead to nutrient deficiencies).</p><p><strong>Conversational Healthcare Systems.</strong> Most of the existing works for generative AI in healthcare are focused on tasks like medical question-answering Singhal et al. (2023b) and EHR summarization Veen et al. (2024). There are very few works focusing on natural dialogue between caregivers and patients. More recently, Tu et al. developed Articulate Medical Intelligence Explorer (AMIE) Tu et al. (2024a), which outlines the importance of diagnostic dialogue to enable physicians to make diagnoses and develop management plans. AMIE is presented as a tool for physicians, and focused on diagnostic use cases. There remains a gap in work addressing the broader range of conversations between a care team and a patient that are neither diagnostic, nor directed to clinical decision making, such as inquiring whether a patient is adhering to their prescription, whether they are following the physician’s pre- and post-procedure directions, and general wellness check-ins. While non-diagnostic, these conversations must still be medically accurate, and critically, must build rapport and trust with the patient to make them feel safe, supported, and confident in their care, while communicating with empathy and bedside manner. Such relationship has shown to lead to better patient satisfaction and, ultimately, better outcomes in real world Derksen et al. (2013). General-purpose LLM’s, however, are not optimized for such objectives. Furthermore, these LLM’s are also not optimized for real-time, voice-based conversations, which can be quite different from text-based conversations. For instance, factors such as response length, quality of voice, pauses and interrupts greatly impact the subjective experience.</p><p><strong>The case for AI-based Healthcare Agents.</strong> The US healthcare industry is facing a massive shortage of healthcare workers, that became even more apparent after the COVID-19 pandemic ora. Exacerbated by burnout, stress and financial conditions, 16.7% of hospitals anticipated a critical staffing shortage in 2023 according to the Department of Health and Human Service AHA. The U.S. Bureau of Labor Statistics estimates the need to fill over 200,000 nursing positions every year until 2031 Fac. A 2023 survey found that 28.7% percent of nurses were considering to leave their jobs. The trend in the decline of the US workforce indicates a shortage of more than 4 million workers nationwide by 2026 ora. In the meantime, the demand for healthcare continues to grow as the population continues to age. There are currently 46 million adults over 65, and it will increase to 64 million by 2030, and 90 million by 2050 Agi.</p><p>Given this massive gap in supply and demand for healthcare workers, and the recent promise of Generative AI to supercharge productivity, we focus on developing a non-diagnostic technology for healthcare workforce augmentation, which we denote as super-staffing. In this work, we develop autonomous generative AI healthcare agents that can safely converse with patients on medical topics. Our goal is to improve patient healthcare outcomes by providing a scalable and safe system that can handle non-diagnostic communications. Such a system will allow the human healthcare providers to focus on top-of-license diagnostic and clinical tasks, thereby helping to alleviate staffing shortages. The agents are designed with built-in safety guardrails that ensure appropriate human supervision.</p><p>Our solution is a multi-agent system with highly specialized healthcare LLMs. The following are the primary contributions of our work.</p><p><strong>Architecture and Training.</strong> We develop a unique multi-agent LLM constellation architecture optimized for real-time healthcare conversation. We employ a primary conversational agent with several specialist support agents for a patient-friendly and medically accurate conversation. The primary agent is trained to be aligned with nurse-like conversations geared for building trust, rapport and empathy with patients, as well as accomplishing healthcare-specific tasks typically performed by nurses, medical assistants, social workers, and nutritionists. We develop techniques to make the primary agent stateful to navigate through a long checklist of care protocols. Our support agents are specialized in healthcare tasks that require a high-level of accuracy, such as confirming that the patient’s reported medicine consumption aligns with the dosage prescribed by their physician, determining whether the patient’s reported OTC drug consumption is within the manufacturer’s recommended range, understanding which medicine the patient is referring to (i.e., patients often struggle with correctly pronouncing drug names, and may confuse ones that sound similar), retrieving current and historical lab results from the patient’s EHR, guiding the patient’s food choices to align with their prescribed diet, etc. The specialist agents provide the relevant context to the primary agent in a message-passing framework, which drives the main conversation.<span style="color:orange;">To this end, we develop custom training protocols for conversational alignment using organic healthcare conversations and simulated ones using patient actors and nurses (U.S. licensed) with agents- and clinicians-in-the-loop for co-operative learning.</span></p><p><strong>Safety.</strong> We adopt a three-pronged approach to safety comprised of: (1) A 70B-100B primary model trained using evidence based content; (2) a novel constellation architecture with multiple models totaling over one trillion parameters, in which a primary LLM is supervised by multiple specialist support models to improve medical accuracy and substantially reduce hallucinations; (3) built-in guardrails that bring in a human supervisor when necessary.</p><p><strong>Evaluation.</strong> To the best of our knowledge, we perform the first extensive real-world evaluation of a healthcare LLM system in which we recruited over 1100 US-licensed nurses and over 130 U.S.-licensed physicians posing as patients for our system. This is focused on an integrated system-level conversational evaluation on dimensions such as medical safety, readiness and bedside manners where we demonstrate parity with human nurses on several key metrics. We also perform a challenging component-level evaluation where we demonstrate that our medium-size specialized agents massively outperform a much larger state-of-the-art general-purpose LLM (GPT-4) on the healthcare tasks as well as outperform an LLM from its own parameter size class (LLaMA-2 70B).</p><h2 id="_2-system-overview" tabindex="-1"><a class="header-anchor" href="#_2-system-overview"><span>2. System Overview</span></a></h2><p>Polaris is architected as a constellation of a primary and multiple specialist LLMs. It also includes the supporting system which orchestrates control flow, inter-model message passing and maintains conversation state. The system is designed to achieve better domain-specific interactions compared to a single general purpose LLM. The healthcare conversation domain is apt for showcasing the value of this paradigm as there are many competing objectives and requirements, including a special emphasis on safety and verification. We further explain the problem domain, system architecture and also provide relevant details on the constituent models in the following sections.</p><h3 id="_2-1-objectives-and-use-cases" tabindex="-1"><a class="header-anchor" href="#_2-1-objectives-and-use-cases"><span>2.1 Objectives and Use Cases</span></a></h3><p>We develop Polaris for patient-facing, real-time healthcare conversation. The objective of this system is to perform low risk non-diagnostic tasks typically performed by nurses, medical assistants, social workers, and nutritionists. The system is constructed for voice-based interaction, as phone calls are the dominant method of communication for many high-volume and high-value healthcare use cases. Building a voice-based autonomous agent is a challenging problem due to factors such as voice quality, pitch, tone, response length, interruptions, and communication delay. Additionally, <span style="color:orange;">Polaris has to take into account errors introduced by the Automated Speech Recognition (ASR) system in the transcription of the audio signal, with a particular focus on the complexity of recognizing healthcare-specific words and phrases</span> (e.g., complex medication names and lab values).</p><p>We train our healthcare agents to accomplish a number of tasks that can be completed via phone calls or voice-only interactions. <span style="color:orange;">Typical objectives</span> for these tasks include general check-in on patient wellness, reviewing compliance with prescribed medicine regimes, confirming appointment details, reviewing procedural logistics, performing diet reviews, communicating lab results, etc. Given that the number of tasks in a typical care protocol can be quite large and extensive, the agent must be able to maintain and update conversation state with each patient, ensuring that all tasks are completed. The task completion rate directly impacts the success rate for the call. At the same time, we <span style="color:orange;">train these agents to have natural conversations that mimic what human caregivers would say, rather than a mere question-answering system as in prior works</span>. For instance, the agent must be able to answer any question the patients may have, address their concerns, and otherwise handle tangential discussions in the conversation. This makes it particularly challenging for the agent to engage in deep conversations with the patient, given that the style, tone and content of these conversations can be quite different from the model’s original training dataset. Such conversation fluidity coupled with its state awareness and medical accuracy remains at the crux of all our design and architectural decisions. Furthermore, we design our system to build trust and rapport with patients, learning about their personality and preferences to demonstrate good bedside manner and leading to higher patient satisfaction and potentially better health outcomes. Our system is deeply specialized in many different medical conditions and procedures. For the purpose of this report, we highlight three representative outbound-call use cases including follow-up calls for post-discharge congestive heart failure (CHF), ongoing care for chronic kidney disease (CKD), and pre-operative check-in for colonoscopy. Figure 2 shows an overview of the different capabilities of our system.</p><div class="hint-container note"><p class="hint-container-title"><span style="color:red;">Key Information</span></p><p><em><strong>Typical objectives</strong></em></p><ol><li>general check-in on patient wellness,</li><li>reviewing compliance with prescribed medicine regimes,</li><li>confirming appointment details,</li><li>reviewing procedural logistics,</li><li>performing diet reviews,</li><li>communicating lab results,</li><li>etc.</li></ol></div><h3 id="_2-2-constellation-architecture" tabindex="-1"><a class="header-anchor" href="#_2-2-constellation-architecture"><span>2.2 Constellation Architecture</span></a></h3><figure><img src="https://arxiv.org/html/2403.13313v1/extracted/5481978/images/training.png" alt="Figure 2: Overview of our training framework for Polaris with registered nurses, patient actors, and LLM agents in the loop." tabindex="0" loading="lazy"><figcaption>Figure 2: Overview of our training framework for Polaris with registered nurses, patient actors, and LLM agents in the loop.</figcaption></figure><p>The core part of Polaris is the multi-agent LLM constellation. As opposed to a general large model performing many different tasks with varying performance, we break down the faculty into medium-size specialist models with consistent high performance. This is beneficial in settings like ours to optimize for tasks with competing objectives, while keeping the latency low for a real-time application. For instance, this allows us to optimize the primary language model for conversational fluidity, rapport-building and empathetic bedside manner with patients.</p><p>Simultaneously, we focus on developing specialized agents with capabilities that serve a dual purpose: (a) assist the main LLM with relevant healthcare-specific context (e.g., A patient with chronic kidney disease stage 3b is recommended to avoid common NSAIDs like advil, motrin); (b) provide a layer of safety to double-check the information provided by the main model (e.g., 40mg of Lasix twice a day vs. 80mg of Lasix once a day). Each of these agents is tied to specific abilities such as confirming that the patient’s reported medicine consumption aligns with the dosage prescribed by their physician, determining whether the patient’s reported OTC drug consumption is within the manufacturer’s recommended range, understanding which medicine the patient is referring to (i.e., patients often struggle with correctly pronouncing drug names, and may confuse ones that sound similar) retrieving current and historical lab results from the patient’s EHR, guiding the patient’s food choices to align with their prescribed diet, etc.</p><p>While Polaris has many such agents, we focus on only a subset of them for illustration. Finally, these agents co-operate to solve a complex task. For instance, the patient utterance ‘‘I am taking dulaglutide. I saw my hemoglobin a1c was 5 - is that normal?’’ requires both the lab agent and the medication agent to work together with the primary agent to formulate the response ‘‘a hemoglobin a1c of 5 is within the normal range and lower than your previous value of 6.5. Your dulaglutide does decrease your hemoglobin a1c level’’.</p><h3 id="_2-3-orchestration" tabindex="-1"><a class="header-anchor" href="#_2-3-orchestration"><span>2.3 Orchestration</span></a></h3><p>The internal state of Polaris evolves as a result of the primary agent’s interactions with the user and the message passing conducted by the support agents. To explain this more clearly we adopt the following notation for the system components:</p><ul><li><strong>Agents:</strong> Let <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>𝒜</mtext><mo>=</mo><mo stretchy="false">{</mo><msub><mi>A</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>A</mi><mi>n</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\\text{𝒜} = \\{A_1, A_2, ..., A_n\\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7em;"></span><span class="mord text"><span class="mord textscr">A</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> be the set of agents, where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">A_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is the primary agent and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>A</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">A_2, ..., A_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> are the support agents.</li><li><strong>Conversation History:</strong> Let <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>t</mi></msub><mo>=</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><msub><mi>u</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>u</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>u</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>r</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">H_t = \\{(u_1, r_1), (u_2, r_2), ..., (u_{t-1}, r_{t-1})\\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{(</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)}</span></span></span></span> be the conversation history up to turn <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>, where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">u_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is the user utterance and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">r_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is the response of the primary agent at turn <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>.</li><li><strong>Agent-Specific Prompts:</strong> Let <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><msub><mi>A</mi><mi>i</mi></msub></msub><mo stretchy="false">(</mo><msub><mi>H</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P_{A_i}(H_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> be the prompt for agent <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">A_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> at turn <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>, derived from the vonversation history <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">H_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</li><li><strong>Support Agent Outputs:</strong> Let <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>O</mi><msub><mi>A</mi><mi>i</mi></msub></msub><mo stretchy="false">(</mo><msub><mi>P</mi><msub><mi>A</mi><mi>i</mi></msub></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O_{A_i}(P_{A_i})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> be the output of support agent <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">A_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> given prompt <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><msub><mi>A</mi><mi>i</mi></msub></msub></mrow><annotation encoding="application/x-tex">P_{A_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9334em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span></span></span></span>. The output space is structured with expected fields, i.g., <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>O</mi><msub><mi>A</mi><mi>i</mi></msub></msub><mo>=</mo><mo stretchy="false">{</mo><msub><mi>f</mi><mn>1</mn></msub><mo>:</mo><msub><mi>v</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>f</mi><mn>2</mn></msub><mo>:</mo><msub><mi>v</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">O_{A_i} = \\{f_1: v_1, f_2: v_2, ...\\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9334em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mclose">}</span></span></span></span>, where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">f_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> are the fields and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">v_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> are the values.</li><li><strong>State Changes:</strong> Let <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">S_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> be the state of Polaris at turn <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>. The sate changes based on the outputs of the support agents, i.e., <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>U</mi><mi>p</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>O</mi><msub><mi>A</mi><mn>2</mn></msub></msub><mo separator="true">,</mo><msub><mi>O</mi><msub><mi>A</mi><mn>3</mn></msub></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>O</mi><msub><mi>A</mi><mi>n</mi></msub></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">S_{t+1} = Update(S_t, O_{A_2}, O_{A_3}, ..., O_{A_n})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord mathnormal">p</span><span class="mord mathnormal">d</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li><li><strong>Prompts:</strong> The prompt for the primary agent at turn <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6984em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> is a function of the updated state and the conversation history, i.e., <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><msub><mi>A</mi><mn>1</mn></msub></msub><mo stretchy="false">(</mo><msub><mi>H</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mtext>，</mtext><msub><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P_{A_1}(H_{t+1}， S_{t+1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">，</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>.</li><li><strong>Short-Horizon Tasks:</strong> These can be represented as additional prompt snippets, e.g., <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mo stretchy="false">{</mo><mi>t</mi><mi>a</mi><mi>s</mi><msub><mi>k</mi><mn>1</mn></msub><mo separator="true">,</mo><mi>t</mi><mi>a</mi><mi>s</mi><msub><mi>k</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">T_{t+1} = \\{task_1, task_2, ...\\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mclose">}</span></span></span></span>, which are appended to the primary agent&#39;s prompt based on the state changes.<br> Polaris mediates the message passing between agents with deterministic imperative programming. This allows us to keep the output space of the support agents well-constrained and implement control-flow logic to support customized protocols. The tasks which are given to the primary agent are systematically formatted and use synthesized information from multiple agents when applicable. This framework facilitates a cooperative approach to complex dialogue generation, where multiple agents contribute to the overall conversation dynamics. An overall step of the constellation system is described in Algorithm 1.</li></ul><h3 id="_2-4-llm-details" tabindex="-1"><a class="header-anchor" href="#_2-4-llm-details"><span>2.4 LLM Details</span></a></h3><p>Our LLM architecture designs and training choices are constrained by the requirement to serve the model in real-time as part of our LLM constellation. As a result, we employ a diverse set of LLMs for the support agents ranging from 50B to 100B parameters, whereas the primary agent is always a medium-size LLM (70B - 100B parameters). All of our models follow a decoder-only transformer-based architecture, and contain between 30 and 100 layers. We use Grouped Query Attention (GQA) Ainslie et al. (2023) to achieve faster inference speeds and reduced memory footprint when storing the KV cache during inference, which in turns allows us to serve larger batch sizes for increased throughput. Different models use different tokenizers depending on the use case and the need for specialized medical terminologies (such as drug names), with vocabulary sizes ranging from 30,000 to 200,000 tokens. The implementation of the attention mechanism employs Flash Attention 2 Dao (2023), which makes the training and inference stages faster, with lower memory footprint and more efficient scaling to longer sequence lengths. All of our models use RMSNorm normalization layers Zhang and Sennrich (2019), SwiGLU activation functions Shazeer (2020), and Rotary Positional Embeddings (RoPE) Su et al. (2024). The maximum context window varies from model to model, ranging from 4,096 to 32,768 tokens. The training runs were performed using a distributed, multi-GPU setup, using several hundred Nvidia H100 GPUs with DeepSpeed Rasley et al. (2020).</p><figure><img src="'+i+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>The primary agent is trained in 3 stages: General Instruction Tuning, Conversation and Agent Tuning, and RLHF. The training and dataset details for the primary agent are discussed in Section 3. The rest of the models are trained using human-labeled datasets, as defined in the respective sections for each agent.</p><p>During inference, we deploy some of our models in bf16 precision and others in int8 precision (using weight-only quantization), depending on the latency and accuracy requirements.</p><div class="hint-container note"><p class="hint-container-title"><span style="color:red;">Key Information</span></p><p><strong>Primary agent training</strong></p><ol><li>General Instruction Tuning</li><li>Conversation and Agent Tuning</li><li>RLHF</li></ol></div><h2 id="_3-conversational-alignment" tabindex="-1"><a class="header-anchor" href="#_3-conversational-alignment"><span>3 Conversational Alignment</span></a></h2><p>In the healthcare domain, the development of a patient-focused clinical framework requires an intelligent conversational agent. This agent has to be designed to foster empathetic engagement with patients, skillfully addressing their concerns and assessing health conditions, be a motivational coach and adopt the multifaceted role of a dietary mentor. It has access to all relevant patient information and medical history to reason and navigate through a complex clinical conversation.</p><h3 id="_3-1-data" tabindex="-1"><a class="header-anchor" href="#_3-1-data"><span>3.1 Data</span></a></h3><p>The development of conversational agents capable of engaging in meaningful and accurate clinical discussions represents a significant challenge. This challenge is compounded by the lack of datasets specifically tailored for training models in the nuanced context of healthcare conversations. Our work addresses this critical gap by leveraging a unique compilation of dialogues, including simulated interactions between registered nurses and patient actors. These dialogues form the cornerstone of our approach to developing a conversational agent with the proficiency to navigate a wide array of clinical discussions. To enhance the agent’s reasoning capabilities, instruction-following proficiency, and domain-specific knowledge – we augmented these datasets by introducing diverse kinds of instructions and tasks geared for multi-hop reasoning. For instance, given a user utterance <strong>“my shoes do not fit”</strong>, the agent should be able to reason about <strong>“swollen ankle → sign of fluid retention → sign of exacerbating CHF conditions”</strong>.</p><p><img src="'+l+'" alt="alt text" loading="lazy"><br><img src="'+r+'" alt="alt text" loading="lazy"></p><h4 id="_3-1-1-foundation-model-training-data" tabindex="-1"><a class="header-anchor" href="#_3-1-1-foundation-model-training-data"><span>3.1.1 Foundation Model Training Data</span></a></h4><p>We first train our foundation model on a massive collection of proprietary data including clinical care plans, healthcare regulatory documents, medical manuals, drug databases, and other high-quality medical reasoning documents. The objective of this phase is to incorporate fine-grained medical knowledge, reasoning and specialized numerical reasoning (e.g., dosage calculations). We further annotated some of the medical datasets with reasoning chains to further enhance the medical reasoning capabilities of the model. Figure 31 shows one of the examples of the medical question answers we leveraged for training our foundation model.</p><h4 id="_3-1-2-simulated-conversations" tabindex="-1"><a class="header-anchor" href="#_3-1-2-simulated-conversations"><span>3.1.2 Simulated Conversations</span></a></h4><p>The nature of our conversational objectives requires specialized data. The agent should<br> be able to maintain conversational state over relatively large time horizon; a multi-turn<br> call in our setting often exceeds 20 minutes with several dozen turns from each speaker.<br><img src="'+p+'" alt="alt text" loading="lazy"><br> It is important to generate data which portrays tougher trajectories within the healthcare setting of our calls. Our system must be robust to handling patients with diverse profiles, for instance, high engagement with many questions or concerns; low regimen compliance; skepticism of AI health services, etc.</p><p>We thus rely on the domain expertise of medical professionals, US-licensed nurses in our setting, to generate accurate data which exhibits comprehensive coverage of our desired data distribution. We leverage a large number of registered nurses, patient actors and our AI-in-the-loop to generate simulated conversations. For targeted medical conditions (e.g., CHF, CKD) and procedures (e.g., post-discharge, pre-operative, chronic-care followups), clinicians create conversational scripts (refer to Table 3 for a simplified version of our CHF script). We also create a large number of fictional patient profiles with different medical histories, condition severity, medications, labs, lifestyle and personality traits (refer to Table4 for a sample patient profile).</p><p>We require clinical expertise to train all parts of Polaris. In order to do this, we employ a bootstrapping strategy for data generation. Initially, we generate conversations using registered nurses and patient actors. We design these conversations to cover a wide breadth of scenarios and behaviors on the part of the simulated patient. We give specific instructions to patient actors to converse such that many of the specialist agents are triggered, such as asking complex questions about medications, mispronouncing medicine names, providing deliberately confusing lab results (e.g., a blood glucose reading in response to a request for their blood pressure reading), asking about hospital specific information (e.g., where to park), etc. During these conversations the registered nurse annotates the transcripts for when these events occurred and what the specialist agents should do during corresponding turns.</p><p><span style="color:orange;">We then proceed to train both the primary and support agents from this collection of datasets</span>. This allows us to start using our trained agents in the conversation instead of nurses; their responses are reviewed by registered nurses with potential re-writes for the noisy turns. We also employ instruction tuned language models to perform data cleaning and augmentation. This is used to improve the style of responses and also create additional variety, preventing mode collapse in the primary agent distribution and ensuring robustness in the support agents. Like most bootstrapping situations, this process becomes more effective with more rounds of training, which allows generalization to new scripts, medications, and so on. Here we provide more details on the entities which participate in the data generation process.<br><img src="'+o+'" alt="alt text" loading="lazy"></p><p><strong>Patient Actors.</strong> Here the actors are asked to play the role of a fictional patient and portray a realistic patient experience. They are encouraged to use the fictional patient’s background as well as their personal experiences and feelings to guide them. We provide them with sample instructions, for instance: Ask about lab values - what they mean, whether they’re normal or not; state they’re taking the wrong medication dosages, or that they are taking medications not on their chart, and so on.</p><p><strong>Registered Nurses.</strong> We ask the nurses to play the role of an ideal nurse at the bedside, on the phone, or in their community. While we provide them with the conversational script with defined call objectives, they are encouraged not to follow the order strictly, but instead follow the natural conversation trajectory for a realistic experience. This allows the patient at times to go on tangents, for instance, sharing their personal experiences that the nurse can engage with to develop rapport and trust; share their health concerns and symptoms that the nurse can both empathize with and educate on.</p><p><strong>Our AI-in-the-Loop.</strong> Once our models are tuned with conversations generated from the earlier phases, we further use them to generate synthetic conversations. Here, the AI plays the role of a nurse with the conversational script and meta instructions used in the prompt as a preamble to converse with the patient actors. This stage is required primarily for tuning our support agents (discussed in Section 7) that generate tasks and provide relevant context to condition the primary agent to generate the response. After our support agent system is sufficiently tuned, we proceed to RLHF data generation. For this we sample multiple responses from the primary agent for the full prompt constructed from the meta-prompt, conversation history and support agent tasks. We leverage our registered nurses to give preference feedback to perform RLHF on the primary agent.</p><h4 id="_3-1-3-conversational-dataset-construction" tabindex="-1"><a class="header-anchor" href="#_3-1-3-conversational-dataset-construction"><span>3.1.3 Conversational Dataset Construction</span></a></h4><h3 id="_3-2-general-instruction-tuning" tabindex="-1"><a class="header-anchor" href="#_3-2-general-instruction-tuning"><span>3.2 General Instruction Tuning</span></a></h3><h3 id="_3-3-conversation-and-agent-tuning" tabindex="-1"><a class="header-anchor" href="#_3-3-conversation-and-agent-tuning"><span>3.3 Conversation and Agent Tuning</span></a></h3><h3 id="_3-4-rlhf" tabindex="-1"><a class="header-anchor" href="#_3-4-rlhf"><span>3.4 RLHF</span></a></h3><h2 id="_4-specialist-support-agents" tabindex="-1"><a class="header-anchor" href="#_4-specialist-support-agents"><span>4 Specialist Support Agents</span></a></h2><h3 id="_4-1-privacy-compliance-specialist" tabindex="-1"><a class="header-anchor" href="#_4-1-privacy-compliance-specialist"><span>4.1 Privacy &amp; Compliance Specialist</span></a></h3><h3 id="_4-2-checklist-specialist" tabindex="-1"><a class="header-anchor" href="#_4-2-checklist-specialist"><span>4.2 Checklist Specialist</span></a></h3><h3 id="_4-3-medication-specialist" tabindex="-1"><a class="header-anchor" href="#_4-3-medication-specialist"><span>4.3 Medication Specialist</span></a></h3><h4 id="_4-3-1-prescription-adherence" tabindex="-1"><a class="header-anchor" href="#_4-3-1-prescription-adherence"><span>4.3.1 Prescription Adherence</span></a></h4><h4 id="_4-3-2-condition-specific-disallowed-otcs" tabindex="-1"><a class="header-anchor" href="#_4-3-2-condition-specific-disallowed-otcs"><span>4.3.2 Condition Specific Disallowed OTCs</span></a></h4><h4 id="_4-3-3-over-the-counter-otc-toxicity" tabindex="-1"><a class="header-anchor" href="#_4-3-3-over-the-counter-otc-toxicity"><span>4.3.3 Over-The-Counter (OTC) Toxicity</span></a></h4><h4 id="_4-3-4-unrecognized-medications-reconciliation" tabindex="-1"><a class="header-anchor" href="#_4-3-4-unrecognized-medications-reconciliation"><span>4.3.4 Unrecognized Medications Reconciliation</span></a></h4><h4 id="_4-3-5-models" tabindex="-1"><a class="header-anchor" href="#_4-3-5-models"><span>4.3.5 Models</span></a></h4><h4 id="_4-3-6-training-data-generation" tabindex="-1"><a class="header-anchor" href="#_4-3-6-training-data-generation"><span>4.3.6 Training Data Generation</span></a></h4><h3 id="_4-4-labs-vitals-specialist" tabindex="-1"><a class="header-anchor" href="#_4-4-labs-vitals-specialist"><span>4.4 Labs &amp; Vitals Specialist</span></a></h3><h4 id="_4-4-1-determination-of-labs-vitals-and-value-extraction" tabindex="-1"><a class="header-anchor" href="#_4-4-1-determination-of-labs-vitals-and-value-extraction"><span>4.4.1 Determination of Labs &amp; Vitals and Value Extraction</span></a></h4><h4 id="_4-4-2-normal-range-assessment-plausibility-check" tabindex="-1"><a class="header-anchor" href="#_4-4-2-normal-range-assessment-plausibility-check"><span>4.4.2 Normal Range Assessment &amp; Plausibility Check</span></a></h4><h4 id="_4-4-3-historical-lab-trends" tabindex="-1"><a class="header-anchor" href="#_4-4-3-historical-lab-trends"><span>4.4.3 Historical Lab Trends</span></a></h4><h4 id="_4-4-4-conditional-factors" tabindex="-1"><a class="header-anchor" href="#_4-4-4-conditional-factors"><span>4.4.4 Conditional Factors</span></a></h4><h4 id="_4-4-5-summary-of-labs-vitals-specialist-capabilities" tabindex="-1"><a class="header-anchor" href="#_4-4-5-summary-of-labs-vitals-specialist-capabilities"><span>4.4.5 Summary of Labs &amp; Vitals Specialist Capabilities</span></a></h4><h4 id="_4-4-6-models" tabindex="-1"><a class="header-anchor" href="#_4-4-6-models"><span>4.4.6 Models</span></a></h4><h4 id="_4-4-7-labs-vitals-specialist-training-datasets" tabindex="-1"><a class="header-anchor" href="#_4-4-7-labs-vitals-specialist-training-datasets"><span>4.4.7 Labs &amp; Vitals Specialist Training Datasets</span></a></h4><h3 id="_4-5-nutrition-specialist" tabindex="-1"><a class="header-anchor" href="#_4-5-nutrition-specialist"><span>4.5 Nutrition Specialist</span></a></h3><h4 id="_4-5-1-workflow" tabindex="-1"><a class="header-anchor" href="#_4-5-1-workflow"><span>4.5.1 Workflow</span></a></h4><h4 id="_4-5-2-chain-restaurant-nutrient-dataset-curation" tabindex="-1"><a class="header-anchor" href="#_4-5-2-chain-restaurant-nutrient-dataset-curation"><span>4.5.2 Chain Restaurant Nutrient Dataset Curation</span></a></h4><h4 id="_4-5-3-models" tabindex="-1"><a class="header-anchor" href="#_4-5-3-models"><span>4.5.3 Models</span></a></h4><h4 id="_4-5-4-training-data-generation" tabindex="-1"><a class="header-anchor" href="#_4-5-4-training-data-generation"><span>4.5.4 Training Data Generation</span></a></h4><h3 id="_4-6-hospital-payor-policy-specialist" tabindex="-1"><a class="header-anchor" href="#_4-6-hospital-payor-policy-specialist"><span>4.6 Hospital &amp; Payor Policy Specialist</span></a></h3><h4 id="_4-6-1-hospital-policy-q-a-within-the-hospital-system" tabindex="-1"><a class="header-anchor" href="#_4-6-1-hospital-policy-q-a-within-the-hospital-system"><span>4.6.1 Hospital Policy Q&amp;A within the Hospital System</span></a></h4><h4 id="_4-6-2-models" tabindex="-1"><a class="header-anchor" href="#_4-6-2-models"><span>4.6.2 Models</span></a></h4><h4 id="_4-6-3-training-data-generation" tabindex="-1"><a class="header-anchor" href="#_4-6-3-training-data-generation"><span>4.6.3 Training Data Generation</span></a></h4><h3 id="_4-7-ehr-summary-specialist" tabindex="-1"><a class="header-anchor" href="#_4-7-ehr-summary-specialist"><span>4.7 EHR Summary Specialist</span></a></h3><h3 id="_4-8-human-intervention-specialist" tabindex="-1"><a class="header-anchor" href="#_4-8-human-intervention-specialist"><span>4.8 Human Intervention Specialist</span></a></h3><h3 id="_4-8-1-models" tabindex="-1"><a class="header-anchor" href="#_4-8-1-models"><span>4.8.1 Models</span></a></h3><h3 id="_4-8-2-training-datasets" tabindex="-1"><a class="header-anchor" href="#_4-8-2-training-datasets"><span>4.8.2 Training Datasets</span></a></h3><h2 id="_5-evaluation" tabindex="-1"><a class="header-anchor" href="#_5-evaluation"><span>5 Evaluation</span></a></h2><h3 id="_5-1-overall-subjective-evaluation" tabindex="-1"><a class="header-anchor" href="#_5-1-overall-subjective-evaluation"><span>5.1 Overall Subjective Evaluation</span></a></h3><h3 id="_5-2-clinical-capability-evaluation" tabindex="-1"><a class="header-anchor" href="#_5-2-clinical-capability-evaluation"><span>5.2 Clinical Capability Evaluation</span></a></h3><h4 id="_5-2-1-medications-and-supplements" tabindex="-1"><a class="header-anchor" href="#_5-2-1-medications-and-supplements"><span>5.2.1 Medications and Supplements</span></a></h4><h4 id="_5-2-2-lab-and-vital-specialist" tabindex="-1"><a class="header-anchor" href="#_5-2-2-lab-and-vital-specialist"><span>5.2.2 Lab and Vital Specialist</span></a></h4><h4 id="_5-2-3-dietary-recommendations" tabindex="-1"><a class="header-anchor" href="#_5-2-3-dietary-recommendations"><span>5.2.3 Dietary Recommendations</span></a></h4><h4 id="_5-2-4-answering-hospital-policy-questions" tabindex="-1"><a class="header-anchor" href="#_5-2-4-answering-hospital-policy-questions"><span>5.2.4 Answering Hospital Policy Questions</span></a></h4><h4 id="_5-2-5-privacy" tabindex="-1"><a class="header-anchor" href="#_5-2-5-privacy"><span>5.2.5 Privacy</span></a></h4><h3 id="_5-3-error-analysis" tabindex="-1"><a class="header-anchor" href="#_5-3-error-analysis"><span>5.3 Error Analysis</span></a></h3><h4 id="_5-3-1-medication-specialist" tabindex="-1"><a class="header-anchor" href="#_5-3-1-medication-specialist"><span>5.3.1 Medication Specialist</span></a></h4><h4 id="_5-3-2-lab-values-and-vital-signs" tabindex="-1"><a class="header-anchor" href="#_5-3-2-lab-values-and-vital-signs"><span>5.3.2 Lab Values and Vital Signs</span></a></h4><h4 id="_5-3-3-nutrition-specialist" tabindex="-1"><a class="header-anchor" href="#_5-3-3-nutrition-specialist"><span>5.3.3 Nutrition Specialist</span></a></h4><h4 id="_5-3-4-hospital-payor-policy-specialist" tabindex="-1"><a class="header-anchor" href="#_5-3-4-hospital-payor-policy-specialist"><span>5.3.4 Hospital &amp; Payor Policy Specialist</span></a></h4><h2 id="_6-related-work" tabindex="-1"><a class="header-anchor" href="#_6-related-work"><span>6 Related Work</span></a></h2><h3 id="_6-1-current-healthcare-challenges" tabindex="-1"><a class="header-anchor" href="#_6-1-current-healthcare-challenges"><span>6.1 Current Healthcare Challenges</span></a></h3><h3 id="_6-2-llms-in-healthcare" tabindex="-1"><a class="header-anchor" href="#_6-2-llms-in-healthcare"><span>6.2 LLMs in Healthcare</span></a></h3><h3 id="_6-3-labor-market-impact-of-healthcare" tabindex="-1"><a class="header-anchor" href="#_6-3-labor-market-impact-of-healthcare"><span>6.3 Labor Market Impact of Healthcare</span></a></h3><h2 id="_7-future-work" tabindex="-1"><a class="header-anchor" href="#_7-future-work"><span>7 Future Work</span></a></h2><h2 id="_8-conclusions" tabindex="-1"><a class="header-anchor" href="#_8-conclusions"><span>8 Conclusions</span></a></h2>',107)]))}const u=a(m,[["render",c],["__file","LLM_Constellation_Architecture_for_Healthcare.html.vue"]]),v=JSON.parse(`{"path":"/models/RAG/LLM_Constellation_Architecture_for_Healthcare.html","title":"LLM Constellation Architecture for Healthcare","lang":"en-US","frontmatter":{"title":"LLM Constellation Architecture for Healthcare","index":true,"icon":"circle-dot","author":"Haiyue","date":"2024-07-11T00:00:00.000Z","category":["model"],"description":"Information came from George in Discord channel meeting summaries at 1:33pm 4 July 2024. This is the notes for paper \\"Polaris: A Safety-focused LLM Constellation Architecture fo...","gitInclude":[],"head":[["meta",{"property":"og:url","content":"https://jet-w.github.io/models/RAG/LLM_Constellation_Architecture_for_Healthcare.html"}],["meta",{"property":"og:site_name","content":"Haiyue's Blog"}],["meta",{"property":"og:title","content":"LLM Constellation Architecture for Healthcare"}],["meta",{"property":"og:description","content":"Information came from George in Discord channel meeting summaries at 1:33pm 4 July 2024. This is the notes for paper \\"Polaris: A Safety-focused LLM Constellation Architecture fo..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://arxiv.org/html/2403.13313v1/x1.png"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"article:author","content":"Haiyue"}],["meta",{"property":"article:published_time","content":"2024-07-11T00:00:00.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"LLM Constellation Architecture for Healthcare\\",\\"image\\":[\\"https://arxiv.org/html/2403.13313v1/x1.png\\",\\"https://arxiv.org/html/2403.13313v1/x2.png\\",\\"https://arxiv.org/html/2403.13313v1/extracted/5481978/images/result-main.png\\",\\"https://arxiv.org/html/2403.13313v1/extracted/5481978/images/training.png\\"],\\"datePublished\\":\\"2024-07-11T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Haiyue\\"}]}"]]},"headers":[{"level":2,"title":"Abstract","slug":"abstract","link":"#abstract","children":[]},{"level":2,"title":"Introduction","slug":"introduction","link":"#introduction","children":[]},{"level":2,"title":"2. System Overview","slug":"_2-system-overview","link":"#_2-system-overview","children":[{"level":3,"title":"2.1 Objectives and Use Cases","slug":"_2-1-objectives-and-use-cases","link":"#_2-1-objectives-and-use-cases","children":[]},{"level":3,"title":"2.2 Constellation Architecture","slug":"_2-2-constellation-architecture","link":"#_2-2-constellation-architecture","children":[]},{"level":3,"title":"2.3 Orchestration","slug":"_2-3-orchestration","link":"#_2-3-orchestration","children":[]},{"level":3,"title":"2.4 LLM Details","slug":"_2-4-llm-details","link":"#_2-4-llm-details","children":[]}]},{"level":2,"title":"3 Conversational Alignment","slug":"_3-conversational-alignment","link":"#_3-conversational-alignment","children":[{"level":3,"title":"3.1 Data","slug":"_3-1-data","link":"#_3-1-data","children":[{"level":4,"title":"3.1.1 Foundation Model Training Data","slug":"_3-1-1-foundation-model-training-data","link":"#_3-1-1-foundation-model-training-data","children":[]},{"level":4,"title":"3.1.2 Simulated Conversations","slug":"_3-1-2-simulated-conversations","link":"#_3-1-2-simulated-conversations","children":[]},{"level":4,"title":"3.1.3 Conversational Dataset Construction","slug":"_3-1-3-conversational-dataset-construction","link":"#_3-1-3-conversational-dataset-construction","children":[]}]},{"level":3,"title":"3.2 General Instruction Tuning","slug":"_3-2-general-instruction-tuning","link":"#_3-2-general-instruction-tuning","children":[]},{"level":3,"title":"3.3 Conversation and Agent Tuning","slug":"_3-3-conversation-and-agent-tuning","link":"#_3-3-conversation-and-agent-tuning","children":[]},{"level":3,"title":"3.4 RLHF","slug":"_3-4-rlhf","link":"#_3-4-rlhf","children":[]}]},{"level":2,"title":"4 Specialist Support Agents","slug":"_4-specialist-support-agents","link":"#_4-specialist-support-agents","children":[{"level":3,"title":"4.1 Privacy & Compliance Specialist","slug":"_4-1-privacy-compliance-specialist","link":"#_4-1-privacy-compliance-specialist","children":[]},{"level":3,"title":"4.2 Checklist Specialist","slug":"_4-2-checklist-specialist","link":"#_4-2-checklist-specialist","children":[]},{"level":3,"title":"4.3 Medication Specialist","slug":"_4-3-medication-specialist","link":"#_4-3-medication-specialist","children":[{"level":4,"title":"4.3.1 Prescription Adherence","slug":"_4-3-1-prescription-adherence","link":"#_4-3-1-prescription-adherence","children":[]},{"level":4,"title":"4.3.2 Condition Specific Disallowed OTCs","slug":"_4-3-2-condition-specific-disallowed-otcs","link":"#_4-3-2-condition-specific-disallowed-otcs","children":[]},{"level":4,"title":"4.3.3 Over-The-Counter (OTC) Toxicity","slug":"_4-3-3-over-the-counter-otc-toxicity","link":"#_4-3-3-over-the-counter-otc-toxicity","children":[]},{"level":4,"title":"4.3.4 Unrecognized Medications Reconciliation","slug":"_4-3-4-unrecognized-medications-reconciliation","link":"#_4-3-4-unrecognized-medications-reconciliation","children":[]},{"level":4,"title":"4.3.5 Models","slug":"_4-3-5-models","link":"#_4-3-5-models","children":[]},{"level":4,"title":"4.3.6 Training Data Generation","slug":"_4-3-6-training-data-generation","link":"#_4-3-6-training-data-generation","children":[]}]},{"level":3,"title":"4.4 Labs & Vitals Specialist","slug":"_4-4-labs-vitals-specialist","link":"#_4-4-labs-vitals-specialist","children":[{"level":4,"title":"4.4.1 Determination of Labs & Vitals and Value Extraction","slug":"_4-4-1-determination-of-labs-vitals-and-value-extraction","link":"#_4-4-1-determination-of-labs-vitals-and-value-extraction","children":[]},{"level":4,"title":"4.4.2 Normal Range Assessment & Plausibility Check","slug":"_4-4-2-normal-range-assessment-plausibility-check","link":"#_4-4-2-normal-range-assessment-plausibility-check","children":[]},{"level":4,"title":"4.4.3 Historical Lab Trends","slug":"_4-4-3-historical-lab-trends","link":"#_4-4-3-historical-lab-trends","children":[]},{"level":4,"title":"4.4.4 Conditional Factors","slug":"_4-4-4-conditional-factors","link":"#_4-4-4-conditional-factors","children":[]},{"level":4,"title":"4.4.5 Summary of Labs & Vitals Specialist Capabilities","slug":"_4-4-5-summary-of-labs-vitals-specialist-capabilities","link":"#_4-4-5-summary-of-labs-vitals-specialist-capabilities","children":[]},{"level":4,"title":"4.4.6 Models","slug":"_4-4-6-models","link":"#_4-4-6-models","children":[]},{"level":4,"title":"4.4.7 Labs & Vitals Specialist Training Datasets","slug":"_4-4-7-labs-vitals-specialist-training-datasets","link":"#_4-4-7-labs-vitals-specialist-training-datasets","children":[]}]},{"level":3,"title":"4.5 Nutrition Specialist","slug":"_4-5-nutrition-specialist","link":"#_4-5-nutrition-specialist","children":[{"level":4,"title":"4.5.1 Workflow","slug":"_4-5-1-workflow","link":"#_4-5-1-workflow","children":[]},{"level":4,"title":"4.5.2 Chain Restaurant Nutrient Dataset Curation","slug":"_4-5-2-chain-restaurant-nutrient-dataset-curation","link":"#_4-5-2-chain-restaurant-nutrient-dataset-curation","children":[]},{"level":4,"title":"4.5.3 Models","slug":"_4-5-3-models","link":"#_4-5-3-models","children":[]},{"level":4,"title":"4.5.4 Training Data Generation","slug":"_4-5-4-training-data-generation","link":"#_4-5-4-training-data-generation","children":[]}]},{"level":3,"title":"4.6 Hospital & Payor Policy Specialist","slug":"_4-6-hospital-payor-policy-specialist","link":"#_4-6-hospital-payor-policy-specialist","children":[{"level":4,"title":"4.6.1 Hospital Policy Q&A within the Hospital System","slug":"_4-6-1-hospital-policy-q-a-within-the-hospital-system","link":"#_4-6-1-hospital-policy-q-a-within-the-hospital-system","children":[]},{"level":4,"title":"4.6.2 Models","slug":"_4-6-2-models","link":"#_4-6-2-models","children":[]},{"level":4,"title":"4.6.3 Training Data Generation","slug":"_4-6-3-training-data-generation","link":"#_4-6-3-training-data-generation","children":[]}]},{"level":3,"title":"4.7 EHR Summary Specialist","slug":"_4-7-ehr-summary-specialist","link":"#_4-7-ehr-summary-specialist","children":[]},{"level":3,"title":"4.8 Human Intervention Specialist","slug":"_4-8-human-intervention-specialist","link":"#_4-8-human-intervention-specialist","children":[]},{"level":3,"title":"4.8.1 Models","slug":"_4-8-1-models","link":"#_4-8-1-models","children":[]},{"level":3,"title":"4.8.2 Training Datasets","slug":"_4-8-2-training-datasets","link":"#_4-8-2-training-datasets","children":[]}]},{"level":2,"title":"5 Evaluation","slug":"_5-evaluation","link":"#_5-evaluation","children":[{"level":3,"title":"5.1 Overall Subjective Evaluation","slug":"_5-1-overall-subjective-evaluation","link":"#_5-1-overall-subjective-evaluation","children":[]},{"level":3,"title":"5.2 Clinical Capability Evaluation","slug":"_5-2-clinical-capability-evaluation","link":"#_5-2-clinical-capability-evaluation","children":[{"level":4,"title":"5.2.1 Medications and Supplements","slug":"_5-2-1-medications-and-supplements","link":"#_5-2-1-medications-and-supplements","children":[]},{"level":4,"title":"5.2.2 Lab and Vital Specialist","slug":"_5-2-2-lab-and-vital-specialist","link":"#_5-2-2-lab-and-vital-specialist","children":[]},{"level":4,"title":"5.2.3 Dietary Recommendations","slug":"_5-2-3-dietary-recommendations","link":"#_5-2-3-dietary-recommendations","children":[]},{"level":4,"title":"5.2.4 Answering Hospital Policy Questions","slug":"_5-2-4-answering-hospital-policy-questions","link":"#_5-2-4-answering-hospital-policy-questions","children":[]},{"level":4,"title":"5.2.5 Privacy","slug":"_5-2-5-privacy","link":"#_5-2-5-privacy","children":[]}]},{"level":3,"title":"5.3 Error Analysis","slug":"_5-3-error-analysis","link":"#_5-3-error-analysis","children":[{"level":4,"title":"5.3.1 Medication Specialist","slug":"_5-3-1-medication-specialist","link":"#_5-3-1-medication-specialist","children":[]},{"level":4,"title":"5.3.2 Lab Values and Vital Signs","slug":"_5-3-2-lab-values-and-vital-signs","link":"#_5-3-2-lab-values-and-vital-signs","children":[]},{"level":4,"title":"5.3.3 Nutrition Specialist","slug":"_5-3-3-nutrition-specialist","link":"#_5-3-3-nutrition-specialist","children":[]},{"level":4,"title":"5.3.4 Hospital & Payor Policy Specialist","slug":"_5-3-4-hospital-payor-policy-specialist","link":"#_5-3-4-hospital-payor-policy-specialist","children":[]}]}]},{"level":2,"title":"6 Related Work","slug":"_6-related-work","link":"#_6-related-work","children":[{"level":3,"title":"6.1 Current Healthcare Challenges","slug":"_6-1-current-healthcare-challenges","link":"#_6-1-current-healthcare-challenges","children":[]},{"level":3,"title":"6.2 LLMs in Healthcare","slug":"_6-2-llms-in-healthcare","link":"#_6-2-llms-in-healthcare","children":[]},{"level":3,"title":"6.3 Labor Market Impact of Healthcare","slug":"_6-3-labor-market-impact-of-healthcare","link":"#_6-3-labor-market-impact-of-healthcare","children":[]}]},{"level":2,"title":"7 Future Work","slug":"_7-future-work","link":"#_7-future-work","children":[]},{"level":2,"title":"8 Conclusions","slug":"_8-conclusions","link":"#_8-conclusions","children":[]}],"readingTime":{"minutes":16.39,"words":4916},"filePathRelative":"models/RAG/LLM_Constellation_Architecture_for_Healthcare.md","localizedDate":"July 11, 2024","excerpt":"<ol>\\n<li>Information came from <a href=\\"https://people.unisa.edu.au/srecko.joksimovic\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">George</a> in Discord channel <code>meeting summaries</code> at 1:33pm 4 July 2024.</li>\\n<li>This is the notes for paper \\"<a href=\\"https://arxiv.org/pdf/2403.13313\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">Polaris: A Safety-focused LLM Constellation Architecture for Healthcare</a>\\". The online version is <a href=\\"https://arxiv.org/html/2403.13313v1#S1\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">here</a>.</li>\\n<li><a href=\\"https://drive.google.com/file/d/1-WoevgM9sMV0jD9NkvaheHhcr5vprGSx/view?usp=sharing\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">Notes on Drawio</a></li>\\n</ol>","autoDesc":true}`);export{u as comp,v as data};
